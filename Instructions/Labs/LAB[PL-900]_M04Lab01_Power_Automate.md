---
lab:
  title: "Задание\_4. Создание автоматизированного решения"
  module: 'Module 4: Describe building automation with Microsoft Power Automate'
---

# Задание 4. Создание автоматизированного решения

**Арендаторы WWL: условия использования.** Если вам предоставляется арендатор в рамках обучения под руководством инструктора, обратите внимание, что арендатор предоставляется для поддержки практических занятий в ходе такого обучения. Арендаторы не должны использоваться совместно или для целей, выходящих за рамки практических занятий. Клиент, используемый в этом курсе, является пробным клиентом. Его нельзя использовать или получить к нему доступ после окончания курса, а также он не подлежит продлению. Клиентов нельзя переводить на платную подписку. Арендаторы, полученные в рамках этого курса, остаются собственностью корпорации Майкрософт, мы оставляем за собой право получить доступ к ним и вернуть их в любое время. 

## Сценарий

Bellows College — это образовательное учреждение с несколькими кампусами и программами. Многие преподаватели и администраторы Bellow College должны посещать мероприятия и приобретать товары. Исторически отслеживание таких расходов было сложной задачей. 

Администрация кампуса хотела бы модернизировать свою систему отчетности о расходах, предоставив сотрудникам цифровой способ уведомления о расходах. 

В рамках этого курса вы создадите приложения и выполните автоматизацию, чтобы сотрудники Bellows College могли управлять расходами. 

В этом задании вы создадите поток Power Automate для отправки по электронной почте копии отчета о расходах, когда сотрудники создают новый отчет о расходах.

## Основные пошаговые действия для выполнения задания

Ниже приведены требования, которые необходимо выполнить для завершения проекта.

- Сотрудники должны получать сообщение электронной почты при отправке отчета о расходах. 

### Необходимые компоненты

- Выполнение **задания 0 модуля 1 "Проверка лабораторной среды"**

## Упражнение 1. Создание потока уведомлений об отчете о расходах

**Цель.** В этом упражнении вы создадите поток Power Automate, реализующий соответствующее требование. 

### Задача 1. Создание потока

1. Перейдите на страницу `https://make.powerapps.com`.

1. При необходимости повторной проверки подлинности нажмите **Войти** и следуйте указаниям на экране.

1. В правом верхнем углу экрана выберите среду **Dev One** (если она еще не выбрана).

1. В левой области навигации щелкните **Потоки**.

1. При появлении запроса выберите **Начало работы**.

1. Нажмите **+ Создать поток**, а затем выберите **Автоматизированный облачный поток**.

1. Введите `Expense Notification` в качестве **имени потока**.

1. В разделе **Выбор триггера потока** найдите Dataverse.

1. Выберите триггер **При добавлении, изменении или удалении строки**, а затем нажмите **Создать**.

1. Укажите условия триггера для потока, как показано ниже.

    1. Выберите **Добавлено** для параметра **Тип изменения**
    
    1. Выберите **Отчеты о расходах** в поле **Имя таблицы**

    1. Выберите значение **Организация** для параметра **Область**

    1. Для настройки шага триггера выберите многоточие (**...**), а затем нажмите **Переименовать**. Переименование шага триггера `When an Expense Report is added` 

Это позволит вам и другим редакторам потока понять назначение шага без изучения подробностей.

### Задача 2. Создание шага для получения строки отчета о расходах

1. Выберите **+ Новый шаг**. На этом шаге будут получены сведения отчета о расходах, включая адрес электронной почты.

1. Найдите Dataverse

1. Выберите действие **Получить строку по ИД**.

1. Выберите **Пользователи** в поле **Имя таблицы**

1. Выберите поле **Идентификатор строки**. Вы увидите, что откроется окно для выбора **Динамического содержимого** или **Выражений**.

1. В поле **Идентификатор строки** выберите **Владелец (значение)** из списка **Динамическое содержимое**. На этом шаге вы ищете владельца для строки отчета о расходах, которая была создана для активации этого потока. 

1. В действии **Выбрать строку по идентификатору** нажмите многоточие (**...**) и выберите **Переименовать**. Переименуйте это действие `Get the Owner`.

Это позволит вам и другим редакторам потока понять назначение шага без изучения подробностей.

### Задача 3. Создание шага для отправки сообщения электронной почты с целью подтверждения отправки отчета о расходах

1. Выберите **+ Новый шаг**. На этом шаге высылается сообщение электронной почты пользователю, отправившему отчет о расходах.

1. Найдите почту и выберите действие **Отправить сообщение электронной почты (версия 2)** из соединителя **Office 365 Outlook**.

1. Если появится запрос на принятие условий использования этого действия, нажмите **Принять**.

1. Выберите поле **Кому** и введите свой личный адрес электронной почты. (Существует множество способов динамического заполнения адреса электронной почты, но для этого упражнения мы назначим его вручную.)  

1. В поле **Тема** введите `Your expense report was submitted`

1. Введите приведенный ниже текст в поле **Текст сообщения**.

Вместо полей, указанных в скобках, необходимо поместить динамическое содержимое. Рекомендуется сначала скопировать и вставить весь текст, а затем добавить динамическое содержимое в нужные места.

    Dear {First Name},
    
    Thank you for submitting your expense report for the total amount of {Report Total Amount} with a due date of {Report Due Date}.
    
     
    Best regards,
    Campus Administration
    Bellows College

1. Выделите текст **{Имя}**. Замените его значением поля **Имя** с шага **Получить владельца**.

1. Выделите текст **{Общая сумма отчета}**. Замените его полем ****"Общий объем отчета"** при добавлении** шага "Отчет о расходах".

1. Выделите текст **{Дата выполнения отчета}**. Замените его полем **даты** выполнения отчета на **шаге "При добавлении** отчета о расходах".

1. Выберите **Сохранить**.

Оставьте эту вкладку потока открытой для выполнения следующей задачи. Поток должен выглядеть примерно так:

![Снимок экрана: только что созданный поток](media/lab-4-create-an-automated-solution-01.png)

### Задача 4. Проверка и тестирование потока

1. Откройте новую вкладку в браузере и перейдите к `https://make.powerapps.com`.

1. В правом верхнем углу экрана выберите среду **Dev One** (если она еще не выбрана).

1. Выберите **Приложения** и откройте **Приложение для отслеживания расходов**.

1. Оставив эту вкладку браузера открытой, вернитесь к предыдущей вкладке с вашим потоком.

1. В командной строке выберите **Тестирование**. Выберите **Вручную** и нажмите **Тестировать**.

1. Перейдите на вкладку браузера с открытым приложением на основе модели.

1. С помощью структуры навигации карты сайта слева выберите **Отчет о расходах**.

1. Нажмите кнопку **+ Создать**, чтобы добавить новую запись **Отчет о расходах**.

1. Заполните запись **Отчет о расходах** следующим образом:

    - **Имя отчета:** `Test Report`

    - **Назначение отчета:** конференция

    - **Дата выполнения отчета:** завтра

1. Нажмите кнопку **Сохранить и закрыть**.

1. Перейдите на вкладку браузера, где запущено тестирование потока. После короткой задержки вы увидите выполнение потока. Здесь вы сможете обнаружить проблемы, если они возникнут в потоке, или подтвердить его успешное выполнение.

После короткой задержки вы увидите письмо в своей папке "Входящие". 

>**Примечание**. Письмо может оказаться в папке нежелательной почты.
